---
jupyter: python3
title: Scrape Reddit Posts
---


```{python}
import pandas as pd
import matplotlib.pyplot as plt
```

```{python}
df = pd.read_parquet("../data/processed/reddit_posts_2.parquet")
```
```{python}
df.head(5)
```
```{python}

df['created'] = pd.to_datetime(df['created'])

df['date'] = df['created'].dt.date
grouped = df.groupby(['date', 'search_query']).size().reset_index(name='count')


pivot_df = grouped.pivot(index='date', columns='search_query', values='count').fillna(0)
```
```{python}

fig, axes = plt.subplots(nrows=len(pivot_df.columns), ncols=1, figsize=(10, len(pivot_df.columns) * 3), sharex=True)

for idx, (query, data) in enumerate(pivot_df.items()):
    ax = axes[idx]
    ax.plot(data.index, data.values, label=query)
    ax.set_title(f"Search Query: {query}")
    ax.set_ylabel('Anzahl der Eintr√§ge')
    ax.legend(loc='upper left')
    ax.grid(True)

plt.xlabel('Datum')
plt.tight_layout()
plt.show()
```
