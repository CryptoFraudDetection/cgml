---
jupyter: python3
title: Scrape Reddit Posts
---

```{python}
import pandas as pd

from CryptoFraudDetection.utils.enums import ScraperNotebookMode, LoggerMode
from CryptoFraudDetection.utils.logger import Logger
from CryptoFraudDetection.scraper.reddit import RedditScraper, scrape_reddit
from CryptoFraudDetection.elasticsearch.data_insertion import insert_dataframe
```

```{python}
logger = Logger(name="scrape_reddit", level=LoggerMode.DEBUG, log_dir="../logs")

MODE=ScraperNotebookMode.WRITE
```

```{python}
reddit_scraper = RedditScraper(logger)
reddit_scraper.start_driver()
```

## Find Post IDs for Fraud Coins

### Find Terra Luna Post ID Just Before Date x in Subreddit CryptoCurrency

```{python}
terra_luna_date = "2024-01-01"
```

```{python}
post_list = reddit_scraper.get_multipage_post_list('r/CryptoCurrency','Terra+Luna', limit=1_000, start_date=terra_luna_date)
```

```{python}
for post in post_list:
    if pd.to_datetime(post['date']).tz_localize(None) < pd.Timestamp(terra_luna_date):
        print(post)
        break
```

### Find Bitcoin Post ID Just Before Date x in Subreddit CryptoCurrency

```{python}
btc_date = "2024-01-01"
```

```{python}
post_list = reddit_scraper.get_multipage_post_list('r/CryptoCurrency','Bitcoin', limit=1_000, start_date=btc_date)
```

```{python}
for post in post_list:
    if pd.to_datetime(post['date']).tz_localize(None) < pd.Timestamp(btc_date):
        print(post)
        break
```

